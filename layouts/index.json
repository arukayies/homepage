{{- $.Scratch.Add "index" slice -}}
{{- range where .Site.RegularPages ".Section" "==" "article" -}}
    {{- $data := dict
        "title" .Title
        "description" .Description
        "summary" .Summary
        "date" (.Date.Format "2006-01-02")
        "lastmod" (.Lastmod.Format "2006-01-02")
        "tags" .Params.tags
        "categories" .Params.categories
        "href" .Permalink
    -}}
    {{- $thumbnail := "" -}}
    {{- with resources.Get .Params.thumbnail -}}
        {{- $thumbnail = .Fill (printf "640x360 center q%d webp" $.Site.Params.imageQuality) -}}
    {{- else -}}
        {{- with resources.Get .Site.Params.defaultNoimage -}}
            {{- $thumbnail = .Fill (printf "640x360 center q%d webp" $.Site.Params.imageQuality) -}}
        {{- end -}}
    {{- end -}}
    {{- $data = merge $data (dict "thumbnail" $thumbnail) -}}
    {{- $.Scratch.Add "index" $data -}}
{{- end -}}
{{- $.Scratch.Get "index" | jsonify -}}
